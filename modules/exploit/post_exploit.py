def run_post_exploitation(session_id, client=None):
    try:
        if client is None:
            from pymetasploit3.msfrpc import MsfRpcClient
            client = MsfRpcClient(username='msf', password='msf', port=55553, ssl=False)

        session = client.sessions.session(session_id)

        sysinfo = session.sysinfo
        user = session.username

        output = f"""
        === Meterpreter Post-Exploitation ===
        Session ID: {session_id}
        Computer: {sysinfo.get('Computer')}
        OS: {sysinfo.get('OS')}
        Architecture: {sysinfo.get('Architecture')}
        User: {user}
        """

        return output.strip()

    except Exception as e:
        return f"[-] Post-exploitation failed: {e}"










